-- Set context
USE DATABASE AIRBYTE_DATABASE;
USE SCHEMA ANALYTICS;

-- Create or replace the DIM_DATE table
CREATE OR REPLACE TABLE AIRBYTE_DATABASE.ANALYTICS.DIM_DATE (
    DATE_ID INT,
    FULL_DATE DATE,
    DAY INT,
    MONTH INT,
    YEAR INT,
    WEEKDAY STRING,
    WEEK INT
);


-- Insertar fechas desde 2005-01-01 hasta hoy
INSERT INTO AIRBYTE_DATABASE.ANALYTICS.DIM_DATE
SELECT
    TO_NUMBER(TO_CHAR(D, 'YYYYMMDD')) AS DATE_ID,
    D AS FULL_DATE,
    DAY(D),
    MONTH(D),
    YEAR(D),
    TRIM(TO_CHAR(D, 'Day')) AS WEEKDAY,
    WEEK(D)
FROM (
    SELECT DATEADD(DAY, ROW_NUMBER() OVER (ORDER BY SEQ4()) - 1, DATE '2005-01-01') AS D
    FROM TABLE(GENERATOR(ROWCOUNT => 10000))
) AS dates
WHERE D <= CURRENT_DATE;
